# 20240328進度報告
---

#### 上次進度
* file storage完成
* 各式議題討論

#### 確認file storage儲存的資料格式
> file storage資料格式受exporter的protocol決定,以otlp來說,資料格式有binary protobuf和json-encoded protobuf  
目前認為要處理otlp protobuf的方式最好是透過file exporter匯出為json

Sunbird端接收telemetry的形式有兩種: push和pull  
就push形式來說,Sunbird的資料接收點是gateway otelcol,而gateway otelcol的file exporter將產生json檔案  
而pull形式有兩種資料接收點:  
1. pulling server接收資料後push到gateway otelcol,如此會是json檔案
2. pulling server接收資料後不經gateway otelcol直接送到某個目的地, 如此就會收到protobuf檔案

**根據官方文檔建議,file storage應該為不同的telemetry目的地都獨立配置一個**  
 
#### OTLP/HTTP Json
目前看到otel doc上有寫關於OTLP/gRPC, OTLP/HTTP的說明發現OTLP/HTTP支援json方式傳輸,如此應該能夠使file storage儲存json檔案  
但仍未實做出json傳輸的功能,它需要使用http模式的otlp,並且header帶有Content-Type: application/json

#### socket-sidecar & pulling server
> 在otelcol-deployment和otelcol-daemonset中都搭配一個socket sidecar,當收到request事件時回傳對應的檔案給pulling server  
但目前只有收到binary protobuf,若要送到gateway otelcol會有困難

#### gateway otelcol中是否會做file storage或任何暫存功能
如果有,可以考慮將pulling server收到的protobuf檔案設定為gateway otelcol的buffer file,讓gateway otelcol自行取用

