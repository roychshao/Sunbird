# 2024-03-01 進度報告
---
針對四個議題: 2/4  

### 議題1: multitenant
OpenTelemetry collector可以支援同種多個receiver和多個exporter  
透過設定collector即可達成設置不同datasource export到不同的observability backend  
另外若要儲存只須更改exporter為file exporter即可
```
reciever:
    otlp:
        endpoint: http://localhost:4317
    otlp/2:
        endpoint: http://localhost:55690
    ...

exporter:
    loki:
        endpoint: http://loki:3100/loki1/api/v1/push
    loki:
        endpoint: http://loki:3100/loki2/api/v1/push
```

### 議題2: offline storage
OpenTelemetry collector自帶使用memory來儲存的機制,但telemetry容易遺失  
透過filestorage extension即可輕鬆達成儲存到file, compaction以及rebound (也可以使用dbstorage extension儲存到關聯式db中,但rebound就不確定)  

> **但OpenTelemetry helm chart中的collector (core版) 不包含filestorage extension**
=> 手動build一個custom collector (contrib版) 並將其替換k8s中的deployment和daementset

### 議題3: access inversion
目前只知道prometheus receiver是基於pull的,而最泛用的otlp receiver只基於push方法  
要穩定使用pull方法需要持久化儲存 => dbstorage/filestorag extention搭配各種sql/file receiver  
> 缺點: 目前大多只支援metrics和logs

或許直接存成檔案壓縮後透過web api存取比較簡潔方便
> 缺點: 由於collector目前沒有支援pull三種signal的receiver,因此sunbird本身需要有一個server進行pull的動作  
後續解壓縮後再以push方式送至外部collector處理?

### 其他
* 將MySQL包成container簡化重現系統的步驟
* 目前卡關: 在local執行的custom collector成功,但在helm chart上執行的custom collector顯示一些components不存在

### 未來
* 將offline storage實現,可demo
* 找出collector中支援三種訊號的pull方法, 若無則建立web server以webhook方式替代
* 實驗




















